<% title = 'è³¼å…¥å±¥æ­´' %>
<div class="container py-4 text-light">
  <h2>ğŸ“œ ãƒ¦ãƒ¼ã‚¶ãƒ¼ <%= user.email %> (ID: <%= userId %>) ã®è³¼å…¥å±¥æ­´</h2>

  <% if (!orders || orders.length === 0) { %>
    <p class="text-center text-muted">è³¼å…¥å±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
  <% } else { %>
    <div class="d-flex flex-column gap-3">
      <% orders.forEach(order => { %>
        <div class="order-card border border-info rounded p-3 shadow-sm">
          <div class="d-flex justify-content-between">
            <span class="badge bg-info text-dark">æ³¨æ–‡ID: <%= order.id %></span>
    <span class="badge bg-warning text-dark">å•†å“ID: <%= order.service_id %></span> <!-- â†å•†å“IDã‚’è¿½åŠ  -->
    <span class="badge bg-secondary">
      ğŸ“… <%= new Date(order.created_at + " UTC").toLocaleString("ja-JP",{timeZone:"Asia/Tokyo"}) %>
    </span>

          </div>
          <h6 class="mt-2 text-white"><%= order.service_name %></h6>
          <p class="mb-1">ğŸ”— <a href="<%= order.link %>" target="_blank" class="text-info">ãƒªãƒ³ã‚¯</a></p>
          <p class="mb-1">ğŸ“¦ æ•°é‡: <%= order.quantity %></p>
          <p class="mb-1">ğŸ’° é‡‘é¡: <span class="text-success"><%= Number(order.price_jpy).toFixed(2) %> å††</span></p>

          <!-- âœ… ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ãƒ•ã‚©ãƒ¼ãƒ  -->
<p class="mb-0 mt-2">
  ğŸš¦ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´:
  <form action="/staff/update-status" method="POST" class="d-inline">
    <input type="hidden" name="orderId" value="<%= order.id %>">
    <select name="status" class="form-select form-select-sm bg-dark text-light d-inline w-auto" onchange="this.form.submit()">
      <option value="pending" <%= order.status === 'pending' ? 'selected' : '' %>>ğŸŸ¡ èªè¨¼ä¸­</option>
      <option value="inprogress" <%= order.status === 'inprogress' ? 'selected' : '' %>>ğŸ”µ é€²è¡Œä¸­</option>
      <option value="completed" <%= order.status === 'completed' ? 'selected' : '' %>>ğŸŸ¢ å®Œäº†</option>
    </select>
  </form>
</p>
        </div>
      <% }) %>
    </div>
  <% } %>

  <div class="mt-3">
    <a href="/staff/users" class="btn btn-outline-light">â† ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã¸æˆ»ã‚‹</a>
  </div>
</div>

<style>
  .order-card {
    background: #111;
    transition: transform 0.2s, box-shadow 0.2s;
  }
  .order-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 0 15px rgba(13,202,240,0.6);
  }
</style>
