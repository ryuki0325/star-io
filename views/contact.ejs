<% title = 'ãŠå•ã„åˆã‚ã›' %>

<div class="container py-4 text-light">
  <h2 class="mb-4">ğŸ“© ãŠå•ã„åˆã‚ã›</h2>

  <% if (success) { %>
    <div class="alert alert-success text-center fw-bold">
      âœ… <%= success %>
    </div>
  <% } %>

  <% if (error) { %>
    <div class="alert alert-danger text-center fw-bold">
      âŒ <%= error %>
    </div>
  <% } %>

  <form id="contactForm" class="bg-dark p-4 rounded border border-info shadow">
   
    <!-- ã‚«ãƒ†ã‚´ãƒª -->
    <div class="mb-3">
      <label class="form-label fw-bold">ã‚«ãƒ†ã‚´ãƒª</label>
      <div class="d-flex gap-2 flex-wrap">
        <button type="button" class="btn btn-outline-info category-btn" data-value="æ³¨æ–‡">æ³¨æ–‡</button>
        <button type="button" class="btn btn-outline-info category-btn" data-value="ã‚µãƒ¼ãƒ“ã‚¹">ã‚µãƒ¼ãƒ“ã‚¹</button>
        <button type="button" class="btn btn-outline-info category-btn" data-value="æ”¯æ‰•ã„">æ”¯æ‰•ã„</button>
        <button type="button" class="btn btn-outline-info category-btn" data-value="ãã®ä»–">ãã®ä»–</button>
      </div>
      <input type="hidden" id="categoryInput">
    </div>

    <!-- ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª -->
    <div class="mb-3">
      <label class="form-label fw-bold">ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª</label>
      <div class="d-flex gap-2 flex-wrap">
        <button type="button" class="btn btn-outline-secondary subcategory-btn" data-value="ä¿è¨¼ä¾é ¼">ä¿è¨¼ä¾é ¼</button>
        <button type="button" class="btn btn-outline-secondary subcategory-btn" data-value="ã‚­ãƒ£ãƒ³ã‚»ãƒ«">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button type="button" class="btn btn-outline-secondary subcategory-btn" data-value="ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—">ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚¢ãƒƒãƒ—</button>
        <button type="button" class="btn btn-outline-secondary subcategory-btn" data-value="ãã®ä»–">ãã®ä»–</button>
      </div>
      <input type="hidden" id="subcategoryInput">
    </div>

    <!-- æ³¨æ–‡ID -->
    <div class="mb-3">
      <label for="orderId" class="form-label fw-bold">æ³¨æ–‡ID</label>
      <input type="text" id="orderId" class="form-control bg-dark text-light border-info">
    </div>

    <!-- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ -->
    <div class="mb-3">
      <label for="email" class="form-label fw-bold">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</label>
      <input type="email" id="email" class="form-control bg-dark text-light border-info" required>
    </div>

    <!-- å†…å®¹ -->
    <div class="mb-3">
      <label for="message" class="form-label fw-bold">å†…å®¹</label>
      <textarea id="message" rows="5" class="form-control bg-dark text-light border-info" required></textarea>
    </div>

    <button type="submit" class="btn btn-info w-100 fw-bold py-2">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ—ãƒªã§é€ä¿¡</button>
  </form>
</div>

<style>
  .category-btn.active, .subcategory-btn.active {
    background-color: #0dcaf0 !important;
    color: #000 !important;
    font-weight: bold;
  }
</style>

<script>
  // âœ… ã‚«ãƒ†ã‚´ãƒªé¸æŠ
  document.querySelectorAll(".category-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      document.querySelectorAll(".category-btn").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      document.getElementById("categoryInput").value = btn.dataset.value;
    });
  });

  // âœ… ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªé¸æŠ
  document.querySelectorAll(".subcategory-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      document.querySelectorAll(".subcategory-btn").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      document.getElementById("subcategoryInput").value = btn.dataset.value;
    });
  });

  // âœ… ãƒ¡ãƒ¼ãƒ«é€ä¿¡ï¼ˆmailtoä½¿ç”¨ï¼‰
  document.getElementById("contactForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const category = document.getElementById("categoryInput").value || "æœªé¸æŠ";
    const subcategory = document.getElementById("subcategoryInput").value || "æœªé¸æŠ";
    const orderId = document.getElementById("orderId").value || "ãªã—";
    const email = document.getElementById("email").value || "æœªå…¥åŠ›";
    const message = document.getElementById("message").value || "";

    // å®›å…ˆï¼ˆã‚ãªãŸã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã«å¤‰æ›´ï¼‰
    const to = "star.company527@gmail.com";

    // ä»¶åã¨æœ¬æ–‡
    const subject = encodeURIComponent(`ã€ãŠå•ã„åˆã‚ã›ã€‘${category} - ${subcategory}`);
    const body = encodeURIComponent(
`ã‚«ãƒ†ã‚´ãƒª: ${category}
ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒª: ${subcategory}
æ³¨æ–‡ID: ${orderId}
ãƒ¡ãƒ¼ãƒ«: ${email}

å†…å®¹:
${message}`
    );

    // âœ… ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ—ãƒªã‚’é–‹ã
    window.location.href = `mailto:${to}?subject=${subject}&body=${body}`;
  });
</script>
