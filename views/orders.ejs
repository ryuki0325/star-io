<% title = 'æ³¨æ–‡å±¥æ­´' %>

<div class="container py-4 text-light">
  <h2 class="mb-4 fw-bold">ğŸ“œ æ³¨æ–‡å±¥æ­´</h2>

  <% if (!orders || orders.length === 0) { %>
    <p class="text-center text-muted">ã¾ã æ³¨æ–‡å±¥æ­´ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
  <% } else { %>
    <div class="d-flex flex-column gap-3">
      <% orders.forEach(order => { %>
        <div class="order-card border border-info rounded p-3 shadow-sm">

          <!-- ä¸Šæ®µ: æ³¨æ–‡ID(æœ¬å®¶å„ªå…ˆ) & æ—¥ä»˜ -->
<div class="d-flex justify-content-between align-items-center mb-2 flex-wrap">
  <!-- âœ… è¡¨ç¤ºã¯æœ¬å®¶IDã‚’æœ€å„ªå…ˆã€ç„¡ã‘ã‚Œã°å†…éƒ¨ID -->
  <span class="badge bg-info text-dark fw-bold px-3 py-2 mb-1">
    ID: <%= order.main_order_id || order.api_order_id || order.provider_order_id || order.id %>
  </span>

  <!-- å†…éƒ¨IDã‚‚å°ã•ãä½µè¨˜ï¼ˆé‹ç”¨ãƒ»å•ã„åˆã‚ã›ç”¨ã€ä¸è¦ãªã‚‰ã“ã®è¡Œã‚’æ¶ˆã—ã¦OKï¼‰ -->
  <% if (order.id && (order.main_order_id || order.api_order_id || order.provider_order_id)) { %>
    <small class="text-muted ms-2 mb-1">
      (å†…éƒ¨: <%= order.id %>)
    </small>
  <% } %>

  <span class="badge bg-dark text-white mb-1 ms-auto">
    ğŸ“… 
    <% if (order.created_at) { %>
      <%= new Date(order.created_at + " UTC").toLocaleString("ja-JP", { timeZone: "Asia/Tokyo" }) %>
    <% } else { %>
      ä¸æ˜
    <% } %>
  </span>
</div>

          <!-- ã‚µãƒ¼ãƒ“ã‚¹å + å•†å“ID -->
          <h5 class="text-white mb-2 fw-bold" style="word-break: break-word;">
            âœ¨ [ID:<%= order.service_id %>] <%= order.service_name || "ã‚µãƒ¼ãƒ“ã‚¹åä¸æ˜" %>
          </h5>

          <!-- ã‚µãƒ¼ãƒ“ã‚¹è©³ç´° -->
          <p class="mb-1">
            ğŸ”— 
            <% if (order.link) { %>
              <a href="<%= order.link %>" target="_blank" class="text-decoration-underline text-info">ãƒªãƒ³ã‚¯</a>
            <% } else { %>
              <span class="text-muted">ãƒªãƒ³ã‚¯ãªã—</span>
            <% } %>
          </p>

          <!-- æ•°é‡ -->
          <p class="mb-1">
            ğŸ“¦ æ•°é‡: 
            <span class="fw-bold text-warning"><%= order.quantity || 0 %></span>
          </p>

          <!-- é‡‘é¡ -->
          <p class="mb-0">
            ğŸ’° é‡‘é¡: 
            <span class="fw-bold text-success">
              <%= Number(order.price_jpy || 0).toFixed(2) %> å††
            </span>
          </p>

          <!-- âœ… ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º -->
          <p class="mt-2 mb-0">
            ğŸš¦ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: 
            <% if (order.status === 'pending') { %>
              <span class="badge bg-warning text-dark">èªè¨¼ä¸­</span>
            <% } else if (order.status === 'inprogress') { %>
              <span class="badge bg-info text-dark">é€²è¡Œä¸­</span>
            <% } else if (order.status === 'completed') { %>
              <span class="badge bg-success">å®Œäº†</span>
            <% } else { %>
              <span class="badge bg-secondary">ä¸æ˜</span>
            <% } %>
          </p>

        </div>
      <% }) %>
    </div>
  <% } %>
</div>

<!-- âœ… ã‚¹ã‚¿ã‚¤ãƒ« -->
<style>
  .order-card {
    background: #111; /* é»’èƒŒæ™¯ */
    transition: transform 0.2s, box-shadow 0.2s;
  }
  .order-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 0 15px rgba(13, 202, 240, 0.6);
  }
</style>
